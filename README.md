# GlobalHookListener-
matlab全局键盘钩子，没人写这个只能自己造了。
本稿在ai辅助下完成，基本的功能ai查的api基本没问题，在目前的使用场景下，也没必要钻研高级功能了，实际上，能在全局侦听部分简单功能键f9这样的，就足够了。
# 介绍
主要用途是拿来后台侦听按键以便执行功能，本人主要用来结合vba在后台调用matlab对word执行些操作，如果你有研究的话，matlab的那些按键回调，鼠标回调都限制在图窗窗口上，外部是不会响应的，然后它也没给解决方案。我就自己找了很多东西，java 的jnativehook-2.2.2.jar试了很久有些问题，import都导不了，最后放弃。现在换的是.net程序集，标准2.0库，SharpHook

自己是跑起来了的，但是用的版本因为改了很多自己的乱七八糟的函数，然后还特别长，就懒得修改为公开发布版本了。

目前上传的钩子类是最早版本的，能跑，但是可能要自己对应改写一些东西。

因为大概只是作为纪念吧，第一次上传东西，估计没人会注意，基本的东西放上去了，就是很多细节没怎么管。路都差不多铺好了，同样想实现类似功能的朋友对照着改改弄弄应该很快，复制个代码拿去继续问ai也可，

# 使用说明

uiohook那个要添加到环境变量，sharphook代码里用netassbly导入了。

press函数放类文件夹外，doif那个是个类方法

# 注意事项
注意：

1.钩子为异步钩，即便在调试状态下，按键的释放等仍会导致钩子对象发生变化，因此有时需要复制对象或者暂存对象结构体

2.matlab的对象管理机制在当前工作区无钩子对象时会销毁，调用delete，导致钩子停止。因此调用函数等行为在跨区时必须保证基础工作区生成或保存一个基准狗子对象

# 补充
现用版本随便复制了点下来，修改思路大概展示了，在txt文件里

